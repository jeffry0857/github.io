<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
        integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
    <title>Slot</title>
    <style>
        .col-1 {
            font-size: 10px;
            margin: 20px;
            width: 150px;
            border-radius: 50%;
        }

        img {
            width: 200px;
        }

        [box-id].active {
            transition: 0s;
            transform: translate(5px, 5px);
            visibility: visible;
        }

        [box-id] {
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: none;
            transition: 0.5s;
            visibility: hidden;
        }

        #number {
            font-size: 25px;
            text-align: center;
            color: chocolate;
        }

        #title {
            font-size: 36px;
            text-align: center;
            color: black;
        }
    </style>
</head>

<body>
    <div class="container m-lg-2">
        <div class="row justify-content-center active">
            <div class="col-lg-3" box-id="1"></div>
            <div class="col-2" box-id="2"></div>
            <div class="col-lg-3" box-id="3"></div>
            <div class="col-2" box-id="4"></div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-3" box-id="5"></div>
            <div class="col-2" box-id="6"></div>
            <div class="col-lg-3" box-id="7"></div>
            <div class="col-2" box-id="8"></div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-3" box-id="9"></div>
            <div class="col-2" box-id="10"></div>
            <div class="col-lg-3" box-id="11"></div>
            <div class="col-2" box-id="12"></div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-3" box-id="13"></div>
            <div class="col-2" box-id="14"></div>
            <div class="col-lg-3" box-id="15"></div>
            <div class="col-2" box-id="16"></div>
        </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-4">
            <p id="title" class="p-3 mt-4 "></p>
            <p id="number" class="p-3 mt-4 "></p>
        </div>
        <div class="col-1">
            <button class="p-3 mt-4 bg-danger text-white border border-danger rounded-3 w-75 h-75 fs-4">紅包抽起來</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

    <script>

        //宣告
        //格子資料
        let brickData = [
            {
                id: '1',
                title: '100塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '馬馬虎虎'
                }
            },
            {
                id: '2',
                title: '一個都沒抽中',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '可憐啊'
                }
            },
            {
                id: '3',
                title: '500塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '運氣還不錯!'
                }
            },
            {
                id: '4',
                title: '100塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '馬馬虎虎'
                }
            },
            {
                id: '5',
                title: '2000塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '恭喜你獲得最高獎'
                }
            },
            {
                id: '6',
                title: '一個都沒抽中',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '可憐啊'
                }
            },
            {
                id: '7',
                title: '1000塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '恭喜你獲得次高獎'
                }
            },
            {
                id: '8',
                title: '一個都沒抽中',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '可憐啊'
                }
            },
            {
                id: '9',
                title: '100塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '馬馬虎虎'
                }
            },
            {
                id: '10',
                title: '一個都沒抽中',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '可憐啊'
                }
            },
            {
                id: '11',
                title: '500塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '運氣還不錯'
                }
            },
            {
                id: '12',
                title: '100塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '馬馬虎虎'
                }
            },
            {
                id: '13',
                title: '2000塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '恭喜你獲得最高獎'
                }
            },
            {
                id: '14',
                title: '一個都沒抽中',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '可憐啊'
                }
            },
            {
                id: '15',
                title: '1000塊',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '恭喜你獲得次高獎'
                }
            },
            {
                id: '16',
                title: '一個都沒抽中',
                pic: '/pngsucai_459289_cab040.png',
                target: function () {
                    return '可憐啊'
                }
            },
        ]

        let steps = 0
        let allSteps = 0
        let currentIndex = 0
        let speed = 100

        //DOM
        let column = document.querySelectorAll('[box-id]')
        const startBtn = document.querySelector('button')
        const numberShow = document.querySelector('#number')
        const titleShow = document.querySelector('#title')
        const img = document.querySelector('img')

        window.onload = function () {
            //塞資料 into
            column.forEach(box => {
                let id = box.getAttributeNode('box-id').value
                let data = brickData.find(x => x.id == id)

                let pic = document.createElement('img')
                pic.setAttribute('src', data.pic)
                box.appendChild(pic)
            })

            startBtn.onclick = function () {

                speed = 100

                let random = Math.floor(Math.random() * brickData.length) + 1

                steps = random + (3 * column.length)
                allSteps = steps
                turnAround()
            }

            //function
            function turnAround() {
                column[currentIndex].classList.remove('active')
                currentIndex++

                if (currentIndex >= column.length)
                    currentIndex = 0

                column[currentIndex].classList.add('active')
                steps--

                if (steps > 0) {
                    setTimeout(turnAround, speed)
                    if (steps < Math.floor(allSteps / 3))
                        speed += 10
                } else {
                    let name = brickData[currentIndex].title
                    titleShow.innerText = ` ${name} `
                    let val = brickData[currentIndex].target()
                    numberShow.innerText = ` ${val} `
                }
            }
        }
    </script>
</body>